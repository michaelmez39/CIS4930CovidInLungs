dataset = merge(x=infected_1, y=uninfected_1, by="gene symbol")
genes = unique(dataset["gene symbol"])
print(genes)
genes
library(data.table)
library(dplyr)
infected_1 = infected_raw[,c(1, 3:8)]
uninfected_1 = uninfected_raw[,c(1, 3:8)]
infected_rows_set = unique(infected_1$"gene symbol")
uninfected_rows_set = unique(uninfected_1$"gene symbol")
data_set = intersect(infected_rows_set, uninfected_rows_set)
infected_1 %>%
group_by("gene symbol")
infected_1 = infected_raw[,c(1, 3:8)]
uninfected_1 = uninfected_raw[,c(1, 3:8)]
infected_rows_set = unique(infected_1$"gene symbol")
uninfected_rows_set = unique(uninfected_1$"gene symbol")
data_set = intersect(infected_rows_set, uninfected_rows_set)
infected_1 %>%
group_by("gene symbol") %>%
summarize(
"1h 4sU Readcount" = median("1h 4sU Readcount")
)
infected_1 = infected_raw[,c(1, 3:8)]
uninfected_1 = uninfected_raw[,c(1, 3:8)]
infected_rows_set = unique(infected_1$"gene symbol")
uninfected_rows_set = unique(uninfected_1$"gene symbol")
data_set = intersect(infected_rows_set, uninfected_rows_set)
infected_1 %>%
group_by(gene symbol) %>%
infected_1 = infected_raw[,c(1, 3:8)]
uninfected_1 = uninfected_raw[,c(1, 3:8)]
infected_rows_set = unique(infected_1$"gene symbol")
uninfected_rows_set = unique(uninfected_1$"gene symbol")
data_set = intersect(infected_rows_set, uninfected_rows_set)
infected_1 %>%
group_by('gene symbol') %>%
summarize(
"1h 4sU Readcount" = median("1h 4sU Readcount")
)
infected_1 = infected_raw[,c(1, 3:8)]
uninfected_1 = uninfected_raw[,c(1, 3:8)]
infected_rows_set = unique(infected_1$"gene symbol")
uninfected_rows_set = unique(uninfected_1$"gene symbol")
data_set = intersect(infected_rows_set, uninfected_rows_set)
data_set %>%
Map(function(name) {
c(name, median(c(infected_1[name], uninfected_1[name])))
})
infected_1 = infected_raw[,c(1, 3:8)]
uninfected_1 = uninfected_raw[,c(1, 3:8)]
infected_rows_set = unique(infected_1$"gene symbol")
uninfected_rows_set = unique(uninfected_1$"gene symbol")
data_set = intersect(infected_rows_set, uninfected_rows_set)
data_set %>%
Map(function(name) {
return c(name, median(c(infected_1[name], uninfected_1[name])))
infected_1 = infected_raw[,c(1, 3:8)]
uninfected_1 = uninfected_raw[,c(1, 3:8)]
infected_rows_set = unique(infected_1$"gene symbol")
uninfected_rows_set = unique(uninfected_1$"gene symbol")
data_set = intersect(infected_rows_set, uninfected_rows_set)
data_set %>%
Map(function(name) {
return name
infected_1 = infected_raw[,c(1, 3:8)]
uninfected_1 = uninfected_raw[,c(1, 3:8)]
infected_rows_set = unique(infected_1$"gene symbol")
uninfected_rows_set = unique(uninfected_1$"gene symbol")
data_set = intersect(infected_rows_set, uninfected_rows_set)
data_set %>%
Map(function(name) {
return name;
infected_1 = infected_raw[,c(1, 3:8)]
uninfected_1 = uninfected_raw[,c(1, 3:8)]
infected_rows_set = unique(infected_1$"gene symbol")
uninfected_rows_set = unique(uninfected_1$"gene symbol")
data_set = intersect(infected_rows_set, uninfected_rows_set)
data_set %>%
Map(function(name) {
name
})
library(data.table)
library(dplyr)
infected_1 = infected_raw[,c(1, 3:8)]
uninfected_1 = uninfected_raw[,c(1, 3:8)]
infected_rows_set = unique(infected_1$"gene symbol")
uninfected_rows_set = unique(uninfected_1$"gene symbol")
infected_1 %>%
group_by("gene symbol") %>%
summarize(median)
infected_1 = infected_raw[,c(1, 3:8)]
uninfected_1 = uninfected_raw[,c(1, 3:8)]
infected_rows_set = unique(infected_1$"gene symbol")
uninfected_rows_set = unique(uninfected_1$"gene symbol")
infected_1 %>%
group_by("gene symbol") %>%
summarize(median())
infected_1 = infected_raw[,c(1, 3:8)]
uninfected_1 = uninfected_raw[,c(1, 3:8)]
infected_rows_set = unique(infected_1$"gene symbol")
uninfected_rows_set = unique(uninfected_1$"gene symbol")
infected_1 %>%
group_by("gene symbol") %>%
summarize(one_hr = median(1h.4sU.Readcount))
rlang::last_error()
infected_1 = infected_raw[,c(1, 3:8)]
uninfected_1 = uninfected_raw[,c(1, 3:8)]
infected_rows_set = unique(infected_1$"gene symbol")
uninfected_rows_set = unique(uninfected_1$"gene symbol")
infected_1 %>%
group_by(gene.symbol) %>%
summarize(
one_hr = median(1h.4sU.Readcount)
infected_1 = infected_raw[,c(1, 3:8)]
uninfected_1 = uninfected_raw[,c(1, 3:8)]
infected_rows_set = unique(infected_1$"gene symbol")
uninfected_rows_set = unique(uninfected_1$"gene symbol")
print(infected_1)
infected_1 %>%
group_by(gene.symbol) %>%
summarize(
one_hr = median(1h.4sU.Readcount)
infected_raw <- data.table("data\\GSE162323_slam_inf_params.txt")
uninfected_raw <- fread("data\\GSE162323_slam_uninf_params.txt")
infected_1 = infected_raw[,c(1, 3:8)]
infected_raw <- data.frame("data\\GSE162323_slam_inf_params.txt")
uninfected_raw <- fread("data\\GSE162323_slam_uninf_params.txt")
infected_1 = infected_raw[,c(1, 3:8)]
infected_raw <- data.frame("data\\GSE162323_slam_inf_params.txt")
print(infected_raw)
uninfected_raw <- fread("data\\GSE162323_slam_uninf_params.txt")
infected_raw <- read.table("data\\GSE162323_slam_inf_params.txt")
infected_raw <- data.frame("data\\GSE162323_slam_inf_params.txt", check.names=TRUE)
uninfected_raw <- fread("data\\GSE162323_slam_uninf_params.txt")
infected_1 = infected_raw[,c(1, 3:8)]
infected_raw <- data.frame("data\\GSE162323_slam_inf_params.txt", check.names=TRUE)
print(infected_raw)
uninfected_raw <- fread("data\\GSE162323_slam_uninf_params.txt")
infected_raw <- data.frame(file="data\\GSE162323_slam_inf_params.txt", check.names=TRUE)
print(infected_raw)
uninfected_raw <- fread("data\\GSE162323_slam_uninf_params.txt")
infected_1 = infected_raw[,c(1, 3:8)]
infected_raw <- data.frame(file="data\\GSE162323_slam_inf_params.txt", check.names=FALSE)
print(infected_raw)
uninfected_raw <- fread("data\\GSE162323_slam_uninf_params.txt")
infected_1 = infected_raw[,c(1, 3:8)]
infected_raw <- fread(file="data\\GSE162323_slam_inf_params.txt", check.names=FALSE)
print(infected_raw)
uninfected_raw <- fread("data\\GSE162323_slam_uninf_params.txt")
infected_raw <- fread(file="data\\GSE162323_slam_inf_params.txt", check.names=TRUE)
print(infected_raw)
uninfected_raw <- fread("data\\GSE162323_slam_uninf_params.txt")
infected_1 = infected_raw[,c(1, 3:8)]
uninfected_1 = uninfected_raw[,c(1, 3:8)]
infected_rows_set = unique(infected_1$"gene symbol")
uninfected_rows_set = unique(uninfected_1$"gene symbol")
print(infected_1)
infected_1 %>%
group_by(gene.symbol) %>%
summarize(
one_hr = median(1h.4sU.Readcount)
infected_1 = infected_raw[,c(1, 3:8)]
uninfected_1 = uninfected_raw[,c(1, 3:8)]
infected_rows_set = unique(infected_1$"gene symbol")
uninfected_rows_set = unique(uninfected_1$"gene symbol")
print(infected_1)
infected_1 %>%
group_by(gene.symbol) %>%
summarize(
one.hour = median(1h.4sU.Readcount)
infected_raw <- fread(file="data\\GSE162323_slam_inf_params.txt", check.names=TRUE)
uninfected_raw <- fread("data\\GSE162323_slam_uninf_params.txt")
infected_1 = infected_raw[,c(1, 3:8)]
uninfected_1 = uninfected_raw[,c(1, 3:8)]
print(infected_1)
infected_rows_set = unique(infected_1$"gene symbol")
uninfected_rows_set = unique(uninfected_1$"gene symbol")
infected_1 %>%
group_by(gene.symbol) %>%
summarize(
one.hour = median(X1h.4sU.Readcount)
)
infected_rows_set = unique(infected_1$"gene symbol")
uninfected_rows_set = unique(uninfected_1$"gene symbol")
infected_1 %>%
group_by(gene.symbol) %>%
summarize(
one.hour = mean(X1h.4sU.Readcount)
)
infected_rows_set = unique(infected_1$"gene symbol")
uninfected_rows_set = unique(uninfected_1$"gene symbol")
infected_1 %>%
group_by(gene.symbol) %>%
summarize(
one.hour = median(X1h.4sU.Readcount)
)
infected_1 %>%
group_by(gene.symbol) %>%
summarize(
one.hour = median(X1h.4sU.Readcount)
two.hour = median(X2h.4sU.Readcount)
infected_rows_set = unique(infected_1$"gene symbol")
uninfected_rows_set = unique(uninfected_1$"gene symbol")
infected_1 %>%
group_by(gene.symbol) %>%
summarize(
one.hour = median(X1h.4sU.Readcount),
two.hour = median(X2h.4sU.Readcount),
three.hour = median(X3h.4sU.Readcount),
four.hour = median(X4h.4sU.Readcount)
)
infected_rows_set = unique(infected_1$"gene symbol")
uninfected_rows_set = unique(uninfected_1$"gene symbol")
infected_1 %>%
group_by(gene.symbol) %>%
summarize(
one.hour = median(X1h.4sU.Readcount),
two.hour = median(X2h.4sU.Readcount),
three.hour = median(X3h.4sU.Readcount)
)
infected_rows_set = unique(infected_1$"gene symbol")
uninfected_rows_set = unique(uninfected_1$"gene symbol")
infected_1 %>%
group_by(gene.symbol) %>%
summarize(
one.hour = median(X1h.4sU.Readcount),
two.hour = median(X2h.4sU.Readcount),
three.hour = median(X3h.4sU.Readcount),
four.hour = median(X4h.4sU.Readcount)
)
infected_rows_set = unique(infected_1$"gene symbol")
uninfected_rows_set = unique(uninfected_1$"gene symbol")
infected_1 %>%
group_by(gene.symbol) %>%
summarize(
one.hour = median(X1h.4sU.Readcount, na.rm=TRUE),
two.hour = median(X2h.4sU.Readcount),
three.hour = median(X3h.4sU.Readcount),
four.hour = median(X4h.4sU.Readcount)
)
infected_rows_set = unique(infected_1$"gene symbol")
uninfected_rows_set = unique(uninfected_1$"gene symbol")
infected_1 %>%
group_by(gene.symbol) %>%
summarize(
one.hour = median(X1h.4sU.Readcount, na.rm=TRUE),
two.hour.rep1 = median(X2h.4sU.rep1.Readcount),
two.hour.rep2 = median(X2h.4sU.rep1.Readcount),
three.hour = median(X3h.4sU.Readcount),
four.hour = median(X4h.4sU.Readcount)
)
infected_rows_set = unique(infected_1$"gene symbol")
uninfected_rows_set = unique(uninfected_1$"gene symbol")
infected_1 %>%
group_by(gene.symbol) %>%
summarize(
one.hour = median(X1h.4sU.Readcount, na.rm=TRUE),
two.hour = median(X2h.4sU.rep1.Readcount),
three.hour = median(X3h.4sU.Readcount),
four.hour = median(X4h.4sU.Readcount)
)
infected_1 %>%
group_by(gene.symbol) %>%
summarize(
one.hour = median(X1h.4sU.Readcount, na.rm=TRUE),
two.hour = median(X2h.4sU.rep1.Readcount),
three.hour = median(X3h.4sU.Readcount),
four.hour = median(X4h.4sU.Readcount)
)
uninfected_1 %>%
group_by(gene.symbol) %>%
summarize(
one.hour = median(X1h.4sU.Readcount, na.rm=TRUE),
two.hour = median(X2h.4sU.rep1.Readcount),
three.hour = median(X3h.4sU.Readcount),
four.hour = median(X4h.4sU.Readcount)
)
infected_raw <- fread(file="data\\GSE162323_slam_inf_params.txt", check.names=TRUE)
uninfected_raw <- fread("data\\GSE162323_slam_uninf_params.txt", check.names=TRUE)
infected_1 = infected_raw[,c(1, 3:8)]
uninfected_1 = uninfected_raw[,c(1, 3:8)]
print(uninfected_1)
infected_1 %>%
group_by(gene.symbol) %>%
summarize(
one.hour = median(X1h.4sU.Readcount, na.rm=TRUE),
two.hour = median(X2h.4sU.rep1.Readcount),
three.hour = median(X3h.4sU.Readcount),
four.hour = median(X4h.4sU.Readcount)
)
uninfected_1 %>%
group_by(gene.symbol) %>%
summarize(
one.hour = median(X1h.4sU.Readcount, na.rm=TRUE),
two.hour = median(X2h.4sU.rep2.Readcount),
three.hour = median(X3h.4sU.Readcount),
four.hour = median(X4h.4sU.Readcount)
)
infected_1 %>%
group_by(gene.symbol) %>%
summarize(
one.hour.inf = median(X1h.4sU.Readcount, na.rm=TRUE),
two.hour.inf = median(X2h.4sU.rep1.Readcount),
three.hour.inf = median(X3h.4sU.Readcount),
four.hour.inf = median(X4h.4sU.Readcount)
)
uninfected_1 %>%
group_by(gene.symbol) %>%
summarize(
one.hour.uninf = median(X1h.4sU.Readcount, na.rm=TRUE),
two.hour.uninf = median(X2h.4sU.rep2.Readcount),
three.hour.uninf = median(X3h.4sU.Readcount),
four.hour.uninf = median(X4h.4sU.Readcount)
)
infected_1 %>%
group_by(gene.symbol) %>%
summarize(
one.hour.inf = median(X1h.4sU.Readcount, na.rm=TRUE),
two.hour.inf = median(X2h.4sU.rep1.Readcount),
three.hour.inf = median(X3h.4sU.Readcount),
four.hour.inf = median(X4h.4sU.Readcount)
)
uninfected_1 %>%
group_by(gene.symbol) %>%
summarize(
one.hour.uninf = median(X1h.4sU.Readcount, na.rm=TRUE),
two.hour.uninf = median(X2h.4sU.rep2.Readcount),
three.hour.uninf = median(X3h.4sU.Readcount),
four.hour.uninf = median(X4h.4sU.Readcount)
)
merge(x=infected_1, y=infected_2, by=gene.symbol)
infected_1 %>%
group_by(gene.symbol) %>%
summarize(
one.hour.inf = median(X1h.4sU.Readcount, na.rm=TRUE),
two.hour.inf = median(X2h.4sU.rep1.Readcount),
three.hour.inf = median(X3h.4sU.Readcount),
four.hour.inf = median(X4h.4sU.Readcount)
)
uninfected_1 %>%
group_by(gene.symbol) %>%
summarize(
one.hour.uninf = median(X1h.4sU.Readcount, na.rm=TRUE),
two.hour.uninf = median(X2h.4sU.rep2.Readcount),
three.hour.uninf = median(X3h.4sU.Readcount),
four.hour.uninf = median(X4h.4sU.Readcount)
)
merge(x=infected_1, y=uninfected_1, by=gene.symbol)
infected_1 %>%
group_by(gene.symbol) %>%
summarize(
one.hour.inf = median(X1h.4sU.Readcount, na.rm=TRUE),
two.hour.inf = median(X2h.4sU.rep1.Readcount),
three.hour.inf = median(X3h.4sU.Readcount),
four.hour.inf = median(X4h.4sU.Readcount)
)
uninfected_1 %>%
group_by(gene.symbol) %>%
summarize(
one.hour.uninf = median(X1h.4sU.Readcount, na.rm=TRUE),
two.hour.uninf = median(X2h.4sU.rep2.Readcount),
three.hour.uninf = median(X3h.4sU.Readcount),
four.hour.uninf = median(X4h.4sU.Readcount)
)
merge(x=infected_1, y=uninfected_1, by="gene.symbol")
infected_dedup = infected_1 %>%
group_by(gene.symbol) %>%
summarize(
one.hour.inf = median(X1h.4sU.Readcount, na.rm=TRUE),
two.hour.inf = median(X2h.4sU.rep1.Readcount),
three.hour.inf = median(X3h.4sU.Readcount),
four.hour.inf = median(X4h.4sU.Readcount)
)
uninfected_dedup = uninfected_1 %>%
group_by(gene.symbol) %>%
summarize(
one.hour.uninf = median(X1h.4sU.Readcount, na.rm=TRUE),
two.hour.uninf = median(X2h.4sU.rep2.Readcount),
three.hour.uninf = median(X3h.4sU.Readcount),
four.hour.uninf = median(X4h.4sU.Readcount)
)
merge(x=infected_dedup, y=uninfected_dedup, by="gene.symbol")
infected_raw <- fread(file="data\\GSE162323_slam_inf_params.txt", check.names=TRUE)
uninfected_raw <- fread("data\\GSE162323_slam_uninf_params.txt", check.names=TRUE)
infected_1 = infected_raw[,c(1, 3:8)]
uninfected_1 = uninfected_raw[,c(1, 3:8)]
infected_dedup <- infected_1 %>%
group_by(gene.symbol) %>%
summarize(
one.hour.inf = median(X1h.4sU.Readcount, na.rm=TRUE),
two.hour.inf = median(X2h.4sU.rep1.Readcount),
three.hour.inf = median(X3h.4sU.Readcount),
four.hour.inf = median(X4h.4sU.Readcount)
)
uninfected_dedup <- uninfected_1 %>%
group_by(gene.symbol) %>%
summarize(
one.hour.uninf = median(X1h.4sU.Readcount, na.rm=TRUE),
two.hour.uninf = median(X2h.4sU.rep2.Readcount),
three.hour.uninf = median(X3h.4sU.Readcount),
four.hour.uninf = median(X4h.4sU.Readcount)
)
cts <- merge(x=infected_dedup, y=uninfected_dedup, by="gene.symbol")
infected_dedup <- infected_1 %>%
group_by(gene.symbol) %>%
summarize(
one.hour.inf = median(X1h.4sU.Readcount, na.rm=TRUE),
two.hour.inf = median(X2h.4sU.rep1.Readcount),
three.hour.inf = median(X3h.4sU.Readcount),
four.hour.inf = median(X4h.4sU.Readcount)
)
uninfected_dedup <- uninfected_1 %>%
group_by(gene.symbol) %>%
summarize(
one.hour.uninf = median(X1h.4sU.Readcount, na.rm=TRUE),
two.hour.uninf = median(X2h.4sU.rep2.Readcount),
three.hour.uninf = median(X3h.4sU.Readcount),
four.hour.uninf = median(X4h.4sU.Readcount)
)
cts <- merge(x=infected_dedup, y=uninfected_dedup, by="gene.symbol")
print(cts)
cts %>%
transmute(
expression = max(one.hour.inf, two.hour.inf, three.hour.inf, four.hour.inf, one.hour.uninf, two.hour.uninf, three.hour.uninf, four.hour.uninf) - min(one.hour.inf, two.hour.inf, three.hour.inf, four.hour.inf, one.hour.uninf, two.hour.uninf, three.hour.uninf, four.hour.uninf)
)
cts %>%
transmute(
expression = max(one.hour.inf, two.hour.inf, three.hour.inf, four.hour.inf, one.hour.uninf, two.hour.uninf, three.hour.uninf, four.hour.uninf) - min(one.hour.inf, two.hour.inf, three.hour.inf, four.hour.inf, one.hour.uninf, two.hour.uninf, three.hour.uninf, four.hour.uninf)
)
print(cts)
cts %>%
mutate(
expression = max(one.hour.inf, two.hour.inf, three.hour.inf, four.hour.inf, one.hour.uninf, two.hour.uninf, three.hour.uninf, four.hour.uninf) - min(one.hour.inf, two.hour.inf, three.hour.inf, four.hour.inf, one.hour.uninf, two.hour.uninf, three.hour.uninf, four.hour.uninf)
)
print(cts)
aggregate(
FUN = function(a) {max(a) - min(a)},
data = cts
)
aggregate(
formula = gene.symbol ~ one.hour.inf, two.hour.inf, three.hour.inf, four.hour.inf, one.hour.uninf, two.hour.uninf, three.hour.uninf, four.hour.uninf
FUN = function(a) {max(a) - min(a)},
aggregate(
formula = gene.symbol ~ one.hour.inf, two.hour.inf, three.hour.inf, four.hour.inf, one.hour.uninf, two.hour.uninf, three.hour.uninf, four.hour.uninf,
FUN = function(a) {max(a) - min(a)},
data = cts
)
aggregate(
formula = gene.symbol ~ (one.hour.inf, two.hour.inf, three.hour.inf, four.hour.inf, one.hour.uninf, two.hour.uninf, three.hour.uninf, four.hour.uninf),
aggregate(
formula = gene.symbol ~ c(one.hour.inf, two.hour.inf, three.hour.inf, four.hour.inf, one.hour.uninf, two.hour.uninf, three.hour.uninf, four.hour.uninf),
FUN = function(a) {max(a) - min(a)},
data = cts
)
aggregate(
formula = gene.symbol ~ one.hour.inf,
FUN = function(a) {max(a) - min(a)},
data = cts
)
aggregate(
FUN = function(a) {max(a) - min(a)},
data = cts
)
aggregate(
x = gene.symbol
FUN = function(a) {max(a) - min(a)},
aggregate(
x = gene.symbol,
FUN = function(a) {max(a) - min(a)},
data = cts
)
aggregate(
x = "gene.symbol",
FUN = function(a) {max(a) - min(a)},
data = cts
)
aggregate(
x = cts,
by="gene.symbol"
FUN = function(a) {max(a) - min(a)},
aggregate(
x = cts,
by="gene.symbol",
FUN = function(a) {max(a) - min(a)},
)
aggregate(
x = cts,
by=[gene.symbol],
aggregate(
x = cts,
by=c(gene.symbol),
FUN = function(a) {max(a) - min(a)},
)
aggregate(
x = cts,
by=c("gene.symbol"),
FUN = function(a) {max(a) - min(a)},
)
aggregate(
x = cts,
by=["gene.symbol"],
aggregate(
x = cts,
by=list("gene.symbol"),
FUN = function(a) {max(a) - min(a)},
)
aggregate(
x = cts,
by=list("gene.symbol"),
FUN = mean,
)

library(dplyr)
infected_1 = infected_raw[,c(1, 3:8)]
uninfected_1 = uninfected_raw[,c(1, 3:8)]
infected_rows_set = unique(infected_1$"gene symbol")
uninfected_rows_set = unique(uninfected_1$"gene symbol")
infected_1 %>%
group_by("gene symbol") %>%
summarize(median)
infected_1 = infected_raw[,c(1, 3:8)]
uninfected_1 = uninfected_raw[,c(1, 3:8)]
infected_rows_set = unique(infected_1$"gene symbol")
uninfected_rows_set = unique(uninfected_1$"gene symbol")
infected_1 %>%
group_by("gene symbol") %>%
summarize(median())
infected_1 = infected_raw[,c(1, 3:8)]
uninfected_1 = uninfected_raw[,c(1, 3:8)]
infected_rows_set = unique(infected_1$"gene symbol")
uninfected_rows_set = unique(uninfected_1$"gene symbol")
infected_1 %>%
group_by("gene symbol") %>%
summarize(one_hr = median(1h.4sU.Readcount))
rlang::last_error()
infected_1 = infected_raw[,c(1, 3:8)]
uninfected_1 = uninfected_raw[,c(1, 3:8)]
infected_rows_set = unique(infected_1$"gene symbol")
uninfected_rows_set = unique(uninfected_1$"gene symbol")
infected_1 %>%
group_by(gene.symbol) %>%
summarize(
one_hr = median(1h.4sU.Readcount)
infected_1 = infected_raw[,c(1, 3:8)]
uninfected_1 = uninfected_raw[,c(1, 3:8)]
infected_rows_set = unique(infected_1$"gene symbol")
uninfected_rows_set = unique(uninfected_1$"gene symbol")
print(infected_1)
infected_1 %>%
group_by(gene.symbol) %>%
summarize(
one_hr = median(1h.4sU.Readcount)
infected_raw <- data.table("data\\GSE162323_slam_inf_params.txt")
uninfected_raw <- fread("data\\GSE162323_slam_uninf_params.txt")
infected_1 = infected_raw[,c(1, 3:8)]
infected_raw <- data.frame("data\\GSE162323_slam_inf_params.txt")
uninfected_raw <- fread("data\\GSE162323_slam_uninf_params.txt")
infected_1 = infected_raw[,c(1, 3:8)]
infected_raw <- data.frame("data\\GSE162323_slam_inf_params.txt")
print(infected_raw)
uninfected_raw <- fread("data\\GSE162323_slam_uninf_params.txt")
infected_raw <- read.table("data\\GSE162323_slam_inf_params.txt")
infected_raw <- data.frame("data\\GSE162323_slam_inf_params.txt", check.names=TRUE)
uninfected_raw <- fread("data\\GSE162323_slam_uninf_params.txt")
infected_1 = infected_raw[,c(1, 3:8)]
infected_raw <- data.frame("data\\GSE162323_slam_inf_params.txt", check.names=TRUE)
print(infected_raw)
uninfected_raw <- fread("data\\GSE162323_slam_uninf_params.txt")
infected_raw <- data.frame(file="data\\GSE162323_slam_inf_params.txt", check.names=TRUE)
print(infected_raw)
uninfected_raw <- fread("data\\GSE162323_slam_uninf_params.txt")
infected_1 = infected_raw[,c(1, 3:8)]
infected_raw <- data.frame(file="data\\GSE162323_slam_inf_params.txt", check.names=FALSE)
print(infected_raw)
uninfected_raw <- fread("data\\GSE162323_slam_uninf_params.txt")
infected_1 = infected_raw[,c(1, 3:8)]
infected_raw <- fread(file="data\\GSE162323_slam_inf_params.txt", check.names=FALSE)
print(infected_raw)
uninfected_raw <- fread("data\\GSE162323_slam_uninf_params.txt")
infected_raw <- fread(file="data\\GSE162323_slam_inf_params.txt", check.names=TRUE)
print(infected_raw)
uninfected_raw <- fread("data\\GSE162323_slam_uninf_params.txt")
infected_1 = infected_raw[,c(1, 3:8)]
uninfected_1 = uninfected_raw[,c(1, 3:8)]
infected_rows_set = unique(infected_1$"gene symbol")
uninfected_rows_set = unique(uninfected_1$"gene symbol")
print(infected_1)
infected_1 %>%
group_by(gene.symbol) %>%
summarize(
one_hr = median(1h.4sU.Readcount)
infected_1 = infected_raw[,c(1, 3:8)]
uninfected_1 = uninfected_raw[,c(1, 3:8)]
infected_rows_set = unique(infected_1$"gene symbol")
uninfected_rows_set = unique(uninfected_1$"gene symbol")
print(infected_1)
infected_1 %>%
group_by(gene.symbol) %>%
summarize(
one.hour = median(1h.4sU.Readcount)
infected_raw <- fread(file="data\\GSE162323_slam_inf_params.txt", check.names=TRUE)
uninfected_raw <- fread("data\\GSE162323_slam_uninf_params.txt")
infected_1 = infected_raw[,c(1, 3:8)]
uninfected_1 = uninfected_raw[,c(1, 3:8)]
print(infected_1)
infected_rows_set = unique(infected_1$"gene symbol")
uninfected_rows_set = unique(uninfected_1$"gene symbol")
infected_1 %>%
group_by(gene.symbol) %>%
summarize(
one.hour = median(X1h.4sU.Readcount)
)
infected_rows_set = unique(infected_1$"gene symbol")
uninfected_rows_set = unique(uninfected_1$"gene symbol")
infected_1 %>%
group_by(gene.symbol) %>%
summarize(
one.hour = mean(X1h.4sU.Readcount)
)
infected_rows_set = unique(infected_1$"gene symbol")
uninfected_rows_set = unique(uninfected_1$"gene symbol")
infected_1 %>%
group_by(gene.symbol) %>%
summarize(
one.hour = median(X1h.4sU.Readcount)
)
infected_1 %>%
group_by(gene.symbol) %>%
summarize(
one.hour = median(X1h.4sU.Readcount)
two.hour = median(X2h.4sU.Readcount)
infected_rows_set = unique(infected_1$"gene symbol")
uninfected_rows_set = unique(uninfected_1$"gene symbol")
infected_1 %>%
group_by(gene.symbol) %>%
summarize(
one.hour = median(X1h.4sU.Readcount),
two.hour = median(X2h.4sU.Readcount),
three.hour = median(X3h.4sU.Readcount),
four.hour = median(X4h.4sU.Readcount)
)
infected_rows_set = unique(infected_1$"gene symbol")
uninfected_rows_set = unique(uninfected_1$"gene symbol")
infected_1 %>%
group_by(gene.symbol) %>%
summarize(
one.hour = median(X1h.4sU.Readcount),
two.hour = median(X2h.4sU.Readcount),
three.hour = median(X3h.4sU.Readcount)
)
infected_rows_set = unique(infected_1$"gene symbol")
uninfected_rows_set = unique(uninfected_1$"gene symbol")
infected_1 %>%
group_by(gene.symbol) %>%
summarize(
one.hour = median(X1h.4sU.Readcount),
two.hour = median(X2h.4sU.Readcount),
three.hour = median(X3h.4sU.Readcount),
four.hour = median(X4h.4sU.Readcount)
)
infected_rows_set = unique(infected_1$"gene symbol")
uninfected_rows_set = unique(uninfected_1$"gene symbol")
infected_1 %>%
group_by(gene.symbol) %>%
summarize(
one.hour = median(X1h.4sU.Readcount, na.rm=TRUE),
two.hour = median(X2h.4sU.Readcount),
three.hour = median(X3h.4sU.Readcount),
four.hour = median(X4h.4sU.Readcount)
)
infected_rows_set = unique(infected_1$"gene symbol")
uninfected_rows_set = unique(uninfected_1$"gene symbol")
infected_1 %>%
group_by(gene.symbol) %>%
summarize(
one.hour = median(X1h.4sU.Readcount, na.rm=TRUE),
two.hour.rep1 = median(X2h.4sU.rep1.Readcount),
two.hour.rep2 = median(X2h.4sU.rep1.Readcount),
three.hour = median(X3h.4sU.Readcount),
four.hour = median(X4h.4sU.Readcount)
)
infected_rows_set = unique(infected_1$"gene symbol")
uninfected_rows_set = unique(uninfected_1$"gene symbol")
infected_1 %>%
group_by(gene.symbol) %>%
summarize(
one.hour = median(X1h.4sU.Readcount, na.rm=TRUE),
two.hour = median(X2h.4sU.rep1.Readcount),
three.hour = median(X3h.4sU.Readcount),
four.hour = median(X4h.4sU.Readcount)
)
infected_1 %>%
group_by(gene.symbol) %>%
summarize(
one.hour = median(X1h.4sU.Readcount, na.rm=TRUE),
two.hour = median(X2h.4sU.rep1.Readcount),
three.hour = median(X3h.4sU.Readcount),
four.hour = median(X4h.4sU.Readcount)
)
uninfected_1 %>%
group_by(gene.symbol) %>%
summarize(
one.hour = median(X1h.4sU.Readcount, na.rm=TRUE),
two.hour = median(X2h.4sU.rep1.Readcount),
three.hour = median(X3h.4sU.Readcount),
four.hour = median(X4h.4sU.Readcount)
)
infected_raw <- fread(file="data\\GSE162323_slam_inf_params.txt", check.names=TRUE)
uninfected_raw <- fread("data\\GSE162323_slam_uninf_params.txt", check.names=TRUE)
infected_1 = infected_raw[,c(1, 3:8)]
uninfected_1 = uninfected_raw[,c(1, 3:8)]
print(uninfected_1)
infected_1 %>%
group_by(gene.symbol) %>%
summarize(
one.hour = median(X1h.4sU.Readcount, na.rm=TRUE),
two.hour = median(X2h.4sU.rep1.Readcount),
three.hour = median(X3h.4sU.Readcount),
four.hour = median(X4h.4sU.Readcount)
)
uninfected_1 %>%
group_by(gene.symbol) %>%
summarize(
one.hour = median(X1h.4sU.Readcount, na.rm=TRUE),
two.hour = median(X2h.4sU.rep2.Readcount),
three.hour = median(X3h.4sU.Readcount),
four.hour = median(X4h.4sU.Readcount)
)
infected_1 %>%
group_by(gene.symbol) %>%
summarize(
one.hour.inf = median(X1h.4sU.Readcount, na.rm=TRUE),
two.hour.inf = median(X2h.4sU.rep1.Readcount),
three.hour.inf = median(X3h.4sU.Readcount),
four.hour.inf = median(X4h.4sU.Readcount)
)
uninfected_1 %>%
group_by(gene.symbol) %>%
summarize(
one.hour.uninf = median(X1h.4sU.Readcount, na.rm=TRUE),
two.hour.uninf = median(X2h.4sU.rep2.Readcount),
three.hour.uninf = median(X3h.4sU.Readcount),
four.hour.uninf = median(X4h.4sU.Readcount)
)
infected_1 %>%
group_by(gene.symbol) %>%
summarize(
one.hour.inf = median(X1h.4sU.Readcount, na.rm=TRUE),
two.hour.inf = median(X2h.4sU.rep1.Readcount),
three.hour.inf = median(X3h.4sU.Readcount),
four.hour.inf = median(X4h.4sU.Readcount)
)
uninfected_1 %>%
group_by(gene.symbol) %>%
summarize(
one.hour.uninf = median(X1h.4sU.Readcount, na.rm=TRUE),
two.hour.uninf = median(X2h.4sU.rep2.Readcount),
three.hour.uninf = median(X3h.4sU.Readcount),
four.hour.uninf = median(X4h.4sU.Readcount)
)
merge(x=infected_1, y=infected_2, by=gene.symbol)
infected_1 %>%
group_by(gene.symbol) %>%
summarize(
one.hour.inf = median(X1h.4sU.Readcount, na.rm=TRUE),
two.hour.inf = median(X2h.4sU.rep1.Readcount),
three.hour.inf = median(X3h.4sU.Readcount),
four.hour.inf = median(X4h.4sU.Readcount)
)
uninfected_1 %>%
group_by(gene.symbol) %>%
summarize(
one.hour.uninf = median(X1h.4sU.Readcount, na.rm=TRUE),
two.hour.uninf = median(X2h.4sU.rep2.Readcount),
three.hour.uninf = median(X3h.4sU.Readcount),
four.hour.uninf = median(X4h.4sU.Readcount)
)
merge(x=infected_1, y=uninfected_1, by=gene.symbol)
infected_1 %>%
group_by(gene.symbol) %>%
summarize(
one.hour.inf = median(X1h.4sU.Readcount, na.rm=TRUE),
two.hour.inf = median(X2h.4sU.rep1.Readcount),
three.hour.inf = median(X3h.4sU.Readcount),
four.hour.inf = median(X4h.4sU.Readcount)
)
uninfected_1 %>%
group_by(gene.symbol) %>%
summarize(
one.hour.uninf = median(X1h.4sU.Readcount, na.rm=TRUE),
two.hour.uninf = median(X2h.4sU.rep2.Readcount),
three.hour.uninf = median(X3h.4sU.Readcount),
four.hour.uninf = median(X4h.4sU.Readcount)
)
merge(x=infected_1, y=uninfected_1, by="gene.symbol")
infected_dedup = infected_1 %>%
group_by(gene.symbol) %>%
summarize(
one.hour.inf = median(X1h.4sU.Readcount, na.rm=TRUE),
two.hour.inf = median(X2h.4sU.rep1.Readcount),
three.hour.inf = median(X3h.4sU.Readcount),
four.hour.inf = median(X4h.4sU.Readcount)
)
uninfected_dedup = uninfected_1 %>%
group_by(gene.symbol) %>%
summarize(
one.hour.uninf = median(X1h.4sU.Readcount, na.rm=TRUE),
two.hour.uninf = median(X2h.4sU.rep2.Readcount),
three.hour.uninf = median(X3h.4sU.Readcount),
four.hour.uninf = median(X4h.4sU.Readcount)
)
merge(x=infected_dedup, y=uninfected_dedup, by="gene.symbol")
infected_raw <- fread(file="data\\GSE162323_slam_inf_params.txt", check.names=TRUE)
uninfected_raw <- fread("data\\GSE162323_slam_uninf_params.txt", check.names=TRUE)
infected_1 = infected_raw[,c(1, 3:8)]
uninfected_1 = uninfected_raw[,c(1, 3:8)]
infected_dedup <- infected_1 %>%
group_by(gene.symbol) %>%
summarize(
one.hour.inf = median(X1h.4sU.Readcount, na.rm=TRUE),
two.hour.inf = median(X2h.4sU.rep1.Readcount),
three.hour.inf = median(X3h.4sU.Readcount),
four.hour.inf = median(X4h.4sU.Readcount)
)
uninfected_dedup <- uninfected_1 %>%
group_by(gene.symbol) %>%
summarize(
one.hour.uninf = median(X1h.4sU.Readcount, na.rm=TRUE),
two.hour.uninf = median(X2h.4sU.rep2.Readcount),
three.hour.uninf = median(X3h.4sU.Readcount),
four.hour.uninf = median(X4h.4sU.Readcount)
)
cts <- merge(x=infected_dedup, y=uninfected_dedup, by="gene.symbol")
infected_dedup <- infected_1 %>%
group_by(gene.symbol) %>%
summarize(
one.hour.inf = median(X1h.4sU.Readcount, na.rm=TRUE),
two.hour.inf = median(X2h.4sU.rep1.Readcount),
three.hour.inf = median(X3h.4sU.Readcount),
four.hour.inf = median(X4h.4sU.Readcount)
)
uninfected_dedup <- uninfected_1 %>%
group_by(gene.symbol) %>%
summarize(
one.hour.uninf = median(X1h.4sU.Readcount, na.rm=TRUE),
two.hour.uninf = median(X2h.4sU.rep2.Readcount),
three.hour.uninf = median(X3h.4sU.Readcount),
four.hour.uninf = median(X4h.4sU.Readcount)
)
cts <- merge(x=infected_dedup, y=uninfected_dedup, by="gene.symbol")
print(cts)
cts %>%
transmute(
expression = max(one.hour.inf, two.hour.inf, three.hour.inf, four.hour.inf, one.hour.uninf, two.hour.uninf, three.hour.uninf, four.hour.uninf) - min(one.hour.inf, two.hour.inf, three.hour.inf, four.hour.inf, one.hour.uninf, two.hour.uninf, three.hour.uninf, four.hour.uninf)
)
cts %>%
transmute(
expression = max(one.hour.inf, two.hour.inf, three.hour.inf, four.hour.inf, one.hour.uninf, two.hour.uninf, three.hour.uninf, four.hour.uninf) - min(one.hour.inf, two.hour.inf, three.hour.inf, four.hour.inf, one.hour.uninf, two.hour.uninf, three.hour.uninf, four.hour.uninf)
)
print(cts)
cts %>%
mutate(
expression = max(one.hour.inf, two.hour.inf, three.hour.inf, four.hour.inf, one.hour.uninf, two.hour.uninf, three.hour.uninf, four.hour.uninf) - min(one.hour.inf, two.hour.inf, three.hour.inf, four.hour.inf, one.hour.uninf, two.hour.uninf, three.hour.uninf, four.hour.uninf)
)
print(cts)
aggregate(
FUN = function(a) {max(a) - min(a)},
data = cts
)
aggregate(
formula = gene.symbol ~ one.hour.inf, two.hour.inf, three.hour.inf, four.hour.inf, one.hour.uninf, two.hour.uninf, three.hour.uninf, four.hour.uninf
FUN = function(a) {max(a) - min(a)},
aggregate(
formula = gene.symbol ~ one.hour.inf, two.hour.inf, three.hour.inf, four.hour.inf, one.hour.uninf, two.hour.uninf, three.hour.uninf, four.hour.uninf,
FUN = function(a) {max(a) - min(a)},
data = cts
)
aggregate(
formula = gene.symbol ~ (one.hour.inf, two.hour.inf, three.hour.inf, four.hour.inf, one.hour.uninf, two.hour.uninf, three.hour.uninf, four.hour.uninf),
aggregate(
formula = gene.symbol ~ c(one.hour.inf, two.hour.inf, three.hour.inf, four.hour.inf, one.hour.uninf, two.hour.uninf, three.hour.uninf, four.hour.uninf),
FUN = function(a) {max(a) - min(a)},
data = cts
)
aggregate(
formula = gene.symbol ~ one.hour.inf,
FUN = function(a) {max(a) - min(a)},
data = cts
)
aggregate(
FUN = function(a) {max(a) - min(a)},
data = cts
)
aggregate(
x = gene.symbol
FUN = function(a) {max(a) - min(a)},
aggregate(
x = gene.symbol,
FUN = function(a) {max(a) - min(a)},
data = cts
)
aggregate(
x = "gene.symbol",
FUN = function(a) {max(a) - min(a)},
data = cts
)
aggregate(
x = cts,
by="gene.symbol"
FUN = function(a) {max(a) - min(a)},
aggregate(
x = cts,
by="gene.symbol",
FUN = function(a) {max(a) - min(a)},
)
aggregate(
x = cts,
by=[gene.symbol],
aggregate(
x = cts,
by=c(gene.symbol),
FUN = function(a) {max(a) - min(a)},
)
aggregate(
x = cts,
by=c("gene.symbol"),
FUN = function(a) {max(a) - min(a)},
)
aggregate(
x = cts,
by=["gene.symbol"],
aggregate(
x = cts,
by=list("gene.symbol"),
FUN = function(a) {max(a) - min(a)},
)
aggregate(
x = cts,
by=list("gene.symbol"),
FUN = mean,
)
library(data.table)
library(dplyr)
library(purrr)
library(DESeq2)
library(ComplexHeatmap)
library(clusterProfiler)
library(DOSE)
library(org.Hs.eg.db)
infected_raw <- fread(file="data/GSE162323_slam_inf_params.txt", check.names=TRUE)
uninfected_raw <- fread("data/GSE162323_slam_uninf_params.txt", check.names=TRUE)
infected_1 = infected_raw[,c(1, 3:8)]
uninfected_1 = uninfected_raw[,c(1, 3:8)]
infected_dedup <- infected_1 %>%
group_by(gene.symbol) %>%
summarize(
one.hour.inf = as.integer(median(X1h.4sU.Readcount, na.rm=TRUE)),
two.hour.inf = as.integer(median(X2h.4sU.rep1.Readcount)),
three.hour.inf = as.integer(median(X3h.4sU.Readcount)),
four.hour.inf = as.integer(median(X4h.4sU.Readcount))
)
uninfected_dedup <- uninfected_1 %>%
group_by(gene.symbol) %>%
summarize(
one.hour.uninf = as.integer(median(X1h.4sU.Readcount, na.rm=TRUE)),
two.hour.uninf = as.integer(median(X2h.4sU.rep2.Readcount)),
three.hour.uninf = as.integer(median(X3h.4sU.Readcount)),
four.hour.uninf = as.integer(median(X4h.4sU.Readcount))
)
cts_merged <- merge(x=infected_dedup, y=uninfected_dedup, by="gene.symbol")
cts <- cts_merged[,-1]
rownames(cts) <- cts_merged[,1]
print(cts)
coldata <- as.data.frame(names(cts))
coldata$condition <- c("infected", "infected", "infected", "infected", "uninfected", "uninfected", "uninfected", "uninfected")
coldata$batch <- c("one", "two", "three", "four", "one", "two", "three", "four")
dds <- DESeqDataSetFromMatrix(countData = cts,
colData = coldata,
design = ~ condition)
dds <- DESeq(dds) #this is doing a lot of number crunching
res <- results(dds)
vsd <- vst(dds, blind=FALSE)
head(res)
dds <- DESeqDataSetFromMatrix(countData = cts,
colData = coldata,
design = ~ condition + batch)
dds <- DESeq(dds) #this is doing a lot of number crunching
res <- results(dds)
vsd <- vst(dds, blind=FALSE)
head(res)
plotPCA(vsd, intgroup=c("condition"))
volcano_plot <- EnhancedVolcano::EnhancedVolcano(
deseq_df,
lab = deseq_df$Gene,
x = "log2FoldChange",
y = "padj",
pCutoff = 0.01
)
set.seed(9823249)
deseq_df <- res |>
as.data.frame() |>
tibble::rownames_to_column("Gene") |>
dplyr::mutate(threshold = padj < 0.05) |>
arrange(desc(log2FoldChange))
head(deseq_df, n=10)
volcano_plot <- EnhancedVolcano::EnhancedVolcano(
deseq_df,
lab = deseq_df$Gene,
x = "log2FoldChange",
y = "padj",
pCutoff = 0.01
)
volcano_plot
geneList <- deseq_df[,3]
names(geneList) = deseq_df[,1]
go_res <- gseGO(
geneList = sort(geneList, decreasing = TRUE),
OrgDb = org.Hs.eg.db,
ont = "BP",
keyType = 'SYMBOL',
pvalueCutoff = 0.05,
verbose = FALSE
)
head(go_res, n=10)

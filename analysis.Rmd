---
title: "R Notebook"
output: html_notebook
---
**include dependencies**
```{r}
library(data.table)
library(dplyr)
```

#### Data Loading
*Only use relevant columns*
```{r}
infected_raw <- fread(file="data/GSE162323_slam_inf_params.txt", check.names=TRUE)
uninfected_raw <- fread("data/GSE162323_slam_uninf_params.txt", check.names=TRUE)
infected_1 = infected_raw[,c(1, 3:8)]
uninfected_1 = uninfected_raw[,c(1, 3:8)]
```

*Remove duplicate rows with median and merge uninfected and infected gene expression datasets*
```{r}
infected_dedup <- infected_1 %>%
  group_by(gene.symbol) %>%
  summarize(
    one.hour.inf = median(X1h.4sU.Readcount, na.rm=TRUE),
    two.hour.inf = median(X2h.4sU.rep1.Readcount),
    three.hour.inf = median(X3h.4sU.Readcount),
    four.hour.inf = median(X4h.4sU.Readcount)
    )

uninfected_dedup <- uninfected_1 %>%
  group_by(gene.symbol) %>%
  summarize(
    one.hour.uninf = median(X1h.4sU.Readcount, na.rm=TRUE),
    two.hour.uninf = median(X2h.4sU.rep2.Readcount),
    three.hour.uninf = median(X3h.4sU.Readcount),
    four.hour.uninf = median(X4h.4sU.Readcount)
    )

cts <- merge(x=infected_dedup, y=uninfected_dedup, by="gene.symbol")
print(cts)
```

#### Per Gene Expression Range
```{r}
diff <- cts[,2:ncol(cts)] |>
  apply(1, function(r) log(max(r) - min(r)))

hist(diff)
```
### Covid 19 Gene Expression Infected vs Uninfected

